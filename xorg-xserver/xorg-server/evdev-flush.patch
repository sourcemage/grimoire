diff --git a/hw/xfree86/common/xf86Xinput.c b/hw/xfree86/common/xf86Xinput.c
index 710e787..dacc3dc 100644
--- a/hw/xfree86/common/xf86Xinput.c
+++ b/hw/xfree86/common/xf86Xinput.c
@@ -423,6 +423,37 @@ NewInputDeviceRequest (InputOption *options, DeviceIntPtr *pdev)
         (!is_auto || xf86Info.autoEnableDevices))
         EnableDevice(dev);
 
+    /* XXX: The VCK always starts with built-in defaults for keymap. These
+     * defaults are different to the evdev ones. When the first key is hit on
+     * an extension device, the keymap is copied into the VCK's and any
+     * changes made at runtime to the VCK map are lost.
+     *
+     * Assumption: if we have at least one evdev keyboard device, we can
+     * ignore kbd devices. Force a SwitchCoreKeyboard so the VCK has the same
+     * keymap as we do.
+     *
+     * Next time we hit a key, we don't change the map over anymore (see
+     * SwitchCoreKeyboard), and live happily ever after.
+     * Until we have 2 physical keyboards. Or the first real keyboard isn't
+     * actually the one we use. Oh well.
+     *
+     */
+    if (dev->key)
+    {
+        InputInfoPtr info;
+
+        /* Search if there is one other keyboard that uses evdev. */
+        for (info = xf86InputDevs; info; info = info->next)
+        {
+            if (info != pInfo && info->dev && info->dev->key &&
+                (strcmp(info->drv->driverName, "evdev") == 0))
+                break;
+        }
+
+        if (!info)
+            SwitchCoreKeyboard(dev);
+    }
+
     *pdev = dev;
     return Success;

