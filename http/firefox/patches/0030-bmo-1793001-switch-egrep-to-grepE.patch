
# HG changeset patch
# User serge-sans-paille <sguelton@mozilla.com>
# Date 1705502237 0
# Node ID fba2b83c6fe029b15ea8d4573961321908eb9a4c
# Parent  0a29fd63bff9404c9db0783f0b16b2b76d39ddb4
Bug 1793001 - s/egrep/grep -E/ r=ahochheiden

Differential Revision: https://phabricator.services.mozilla.com/D197508

diff --git a/build/autoconf/acgeneral.m4 b/build/autoconf/acgeneral.m4
--- a/build/autoconf/acgeneral.m4
+++ b/build/autoconf/acgeneral.m4
@@ -1699,17 +1699,17 @@ cat > conftest.$ac_ext <<EOF
 #include "confdefs.h"
 [$2]
 EOF
 dnl eval is necessary to expand ac_cpp.
 dnl Ultrix and Pyramid sh refuse to redirect output of eval, so use subshell.
 if (eval "$ac_cpp conftest.$ac_ext") 2>&AC_FD_CC |
 dnl Prevent m4 from eating character classes:
 changequote(, )dnl
-  egrep "$1" >/dev/null 2>&1; then
+  grep -E "$1" >/dev/null 2>&1; then
 changequote([, ])dnl
   ifelse([$3], , :, [rm -rf conftest*
   $3])
 ifelse([$4], , , [else
   rm -rf conftest*
   $4
 ])dnl
 fi
diff --git a/build/autoconf/acspecific.m4 b/build/autoconf/acspecific.m4
--- a/build/autoconf/acspecific.m4
+++ b/build/autoconf/acspecific.m4
@@ -255,31 +255,31 @@ cross_compiling=$ac_cv_prog_f77_cross
 AC_DEFUN(AC_PROG_CC_GNU,
 [AC_CACHE_CHECK(whether we are using GNU C, ac_cv_prog_gcc,
 [dnl The semicolon is to pacify NeXT's syntax-checking cpp.
 cat > conftest.c <<EOF
 #ifdef __GNUC__
   yes;
 #endif
 EOF
-if AC_TRY_COMMAND(${CC-cc} -E conftest.c) | egrep yes >/dev/null 2>&1; then
+if AC_TRY_COMMAND(${CC-cc} -E conftest.c) | grep -E yes >/dev/null 2>&1; then
   ac_cv_prog_gcc=yes
 else
   ac_cv_prog_gcc=no
 fi])])
 
 AC_DEFUN(AC_PROG_CXX_GNU,
 [AC_CACHE_CHECK(whether we are using GNU C++, ac_cv_prog_gxx,
 [dnl The semicolon is to pacify NeXT's syntax-checking cpp.
 cat > conftest.C <<EOF
 #ifdef __GNUC__
   yes;
 #endif
 EOF
-if AC_TRY_COMMAND(${CXX-g++} -E conftest.C) | egrep yes >/dev/null 2>&1; then
+if AC_TRY_COMMAND(${CXX-g++} -E conftest.C) | grep -E yes >/dev/null 2>&1; then
   ac_cv_prog_gxx=yes
 else
   ac_cv_prog_gxx=no
 fi])])
 
 dnl Test whether for Fortran 77 compiler is `g77' (the GNU Fortran 77
 dnl Compiler).  This test depends on whether the Fortran 77 compiler can
 dnl do CPP pre-processing.
@@ -287,17 +287,17 @@ dnl
 dnl AC_PROG_F77_GNU()
 AC_DEFUN(AC_PROG_F77_GNU,
 [AC_CACHE_CHECK(whether we are using GNU Fortran 77, ac_cv_prog_g77,
 [cat > conftest.fpp <<EOF
 #ifdef __GNUC__
   yes
 #endif
 EOF
-if AC_TRY_COMMAND($F77 -E conftest.fpp) | egrep yes >/dev/null 2>&1; then
+if AC_TRY_COMMAND($F77 -E conftest.fpp) | grep -E yes >/dev/null 2>&1; then
   ac_cv_prog_g77=yes
 else
   ac_cv_prog_g77=no
 fi])])
 
 AC_DEFUN(AC_PROG_CC_G,
 [AC_CACHE_CHECK(whether ${CC-cc} accepts -g, ac_cv_prog_cc_g,
 [echo 'void f(){}' > conftest.c
diff --git a/js/src/old-configure.in b/js/src/old-configure.in
--- a/js/src/old-configure.in
+++ b/js/src/old-configure.in
@@ -613,17 +613,17 @@ then
 	dnl See if -pthread is supported.
 	dnl
 	rm -f conftest*
 	ac_cv_have_dash_pthread=no
 	AC_MSG_CHECKING(whether ${CC-cc} accepts -pthread)
 	echo 'int main() { return 0; }' | cat > conftest.c
 	${CC-cc} -pthread -o conftest conftest.c > conftest.out 2>&1
 	if test $? -eq 0; then
-		if test -z "`egrep -i '(unrecognize|unknown)' conftest.out | grep pthread`" -a -z "`egrep -i '(error|incorrect)' conftest.out`" ; then
+		if test -z "`grep -E -i '(unrecognize|unknown)' conftest.out | grep pthread`" -a -z "`grep -E -i '(error|incorrect)' conftest.out`" ; then
 			ac_cv_have_dash_pthread=yes
 	        case "$target_os" in
 	        freebsd*)
 # Freebsd doesn't use -pthread for compiles, it uses them for linking
                 ;;
 	        *)
 			    CFLAGS="$CFLAGS -pthread"
 			    CXXFLAGS="$CXXFLAGS -pthread"
@@ -638,17 +638,17 @@ then
 	dnl See if -pthreads is supported.
 	dnl
     ac_cv_have_dash_pthreads=no
     if test "$ac_cv_have_dash_pthread" = "no"; then
 	    AC_MSG_CHECKING(whether ${CC-cc} accepts -pthreads)
     	echo 'int main() { return 0; }' | cat > conftest.c
 	    ${CC-cc} -pthreads -o conftest conftest.c > conftest.out 2>&1
     	if test $? -eq 0; then
-	    	if test -z "`egrep -i '(unrecognize|unknown)' conftest.out | grep pthreads`" -a -z "`egrep -i '(error|incorrect)' conftest.out`" ; then
+	    	if test -z "`grep -E -i '(unrecognize|unknown)' conftest.out | grep pthreads`" -a -z "`grep -E -i '(error|incorrect)' conftest.out`" ; then
 			    ac_cv_have_dash_pthreads=yes
 			    CFLAGS="$CFLAGS -pthreads"
 			    CXXFLAGS="$CXXFLAGS -pthreads"
 		    fi
 	    fi
 	    rm -f conftest*
     	AC_MSG_RESULT($ac_cv_have_dash_pthreads)
     fi
diff --git a/old-configure.in b/old-configure.in
--- a/old-configure.in
+++ b/old-configure.in
@@ -652,17 +652,17 @@ then
     dnl See if -pthread is supported.
     dnl
     rm -f conftest*
     ac_cv_have_dash_pthread=no
     AC_MSG_CHECKING(whether ${CC-cc} accepts -pthread)
     echo 'int main() { return 0; }' | cat > conftest.c
     ${CC-cc} -pthread -o conftest conftest.c > conftest.out 2>&1
     if test $? -eq 0; then
-        if test -z "`egrep -i '(unrecognize|unknown)' conftest.out | grep pthread`" -a -z "`egrep -i '(error|incorrect)' conftest.out`" ; then
+        if test -z "`grep -E -i '(unrecognize|unknown)' conftest.out | grep pthread`" -a -z "`grep -E -i '(error|incorrect)' conftest.out`" ; then
             ac_cv_have_dash_pthread=yes
             case "$target_os" in
             freebsd*)
 # Freebsd doesn't use -pthread for compiles, it uses them for linking
                 ;;
             *)
                 CFLAGS="$CFLAGS -pthread"
                 CXXFLAGS="$CXXFLAGS -pthread"
@@ -677,17 +677,17 @@ then
     dnl See if -pthreads is supported.
     dnl
     ac_cv_have_dash_pthreads=no
     if test "$ac_cv_have_dash_pthread" = "no"; then
         AC_MSG_CHECKING(whether ${CC-cc} accepts -pthreads)
         echo 'int main() { return 0; }' | cat > conftest.c
         ${CC-cc} -pthreads -o conftest conftest.c > conftest.out 2>&1
         if test $? -eq 0; then
-            if test -z "`egrep -i '(unrecognize|unknown)' conftest.out | grep pthreads`" -a -z "`egrep -i '(error|incorrect)' conftest.out`" ; then
+            if test -z "`grep -E -i '(unrecognize|unknown)' conftest.out | grep pthreads`" -a -z "`grep -E -i '(error|incorrect)' conftest.out`" ; then
                 ac_cv_have_dash_pthreads=yes
                 CFLAGS="$CFLAGS -pthreads"
                 CXXFLAGS="$CXXFLAGS -pthreads"
             fi
         fi
         rm -f conftest*
         AC_MSG_RESULT($ac_cv_have_dash_pthreads)
     fi

