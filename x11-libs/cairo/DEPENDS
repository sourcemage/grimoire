. "$GRIMOIRE/FUNCTIONS" &&

depends freetype2 '--enable-ft' &&
depends fontconfig &&
depends pixman &&

if spell_ok pixman && is_version_less $(installed_version pixman) 0.18.4; then
  force_depends pixman
fi &&

optional_depends zlib \
                 "--enable-xml" \
                 "--disable-xml" \
                 "for XML surface backend" &&

optional_depends libxcb \
                 "--enable-xcb" \
                 "--disable-xcb" \
                 "for XCB surface backend feature" &&

optional_depends libx11 \
                   "--enable-xlib" \
                   "--disable-xlib" \
                   "for Xlib surface backend feature" &&

if is_depends_enabled $SPELL libx11; then
  optional_depends libxrender \
                   "--enable-xlib-xrender" \
                   "--disable-xlib-xrender" \
                   "for Xlib Xrender surface backend" &&

  config_query_option CAIRO_OPTS "Enable Xlib/XCB functions feature?" n \
                                 "--enable-xlib-xcb" \
                                 "--disable-xlib-xcb"
fi &&

optional_depends udev \
                 "--enable-drm" \
                 "--disable-drm" \
                 "for drm support" &&

# these options are bogus
#if is_depends_enabled $SPELL udev; then
#  config_query_option CAIRO_OPTS "Enable XCB drm functions feature?" n \
#                                 "--enable-xcb-drm" \
#                                 "--disable-xcb-drm" &&
#  optional_depends xorg-server \
#                   "--enable-drm-xr" \
#                   "--disable-drm-xr" \
#                   "for DRM Xr (DDX) functions feature"
#fi &&

optional_depends libpng \
                 "--enable-png --enable-svg" \
                 "--disable-png --disable-svg" \
                 "for PNG support" &&

optional_depends OPENGL \
                 "--enable-gl" \
                 "--disable-gl" \
                 "for OpenGL accelerated graphics" &&

optional_depends directfb \
                 "--enable-directfb" \
                 "--disable-directfb" \
                 "for directfb surface backend feature" &&

optional_depends gtk-doc \
                 "--enable-gtk-doc" \
                 "--disable-gtk-doc" \
                 "Build documentation with gtk-doc" &&

optional_depends valgrind \
                 "--enable-valgrind" \
                 "--disable-valgrind" \
                 "for Valgrind support"
